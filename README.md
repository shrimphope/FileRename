# 批量文件名修改工具

这是一个功能完善的批量文件名修改工具，使用Python和PyQt5开发，提供直观的图形用户界面，支持多种重命名模式、文件筛选和撤销功能。

## 功能特性

### 重命名模式
- **添加前缀/后缀**：在文件名前后添加指定文本
- **替换字符串**：将文件名中的指定字符串替换为新字符串
- **正则表达式替换**：使用正则表达式匹配并替换文件名中的内容
- **序号重命名**：使用序号替换文件名，支持自定义起始序号、格式和位数

### 文件筛选
- **按文件类型筛选**：支持选择特定文件扩展名
- **按文件大小筛选**：设置最小和最大文件大小过滤条件
- **按修改日期筛选**：设置日期范围过滤文件

### 跨文件夹操作
- **目标文件夹选择**：可以将重命名后的文件复制到不同的文件夹中，保留原始文件
- **智能目录创建**：自动创建不存在的目标文件夹
- **撤销/重做支持**：跨文件夹操作同样支持撤销和重做功能

### 其他功能
- **实时预览**：在执行重命名前查看修改效果
- **撤销/重做**：支持撤销和重做操作，防止误操作
- **进度显示**：大文件批量操作时显示进度
- **错误处理**：完善的文件权限检查、文件名冲突处理和特殊字符处理

## 安装方法

### 系统要求
- Windows 10/11
- Python 3.7 或更高版本
- PyQt5 5.15.0 或更高版本

### 安装步骤

1. 确保已安装Python
   访问 [Python官网](https://www.python.org/downloads/) 下载并安装Python 3.7+

2. 安装依赖
   ```bash
   pip install -r requirements.txt
   ```

3. 运行程序
   ```bash
   python main.py
   ```

## 使用指南

### 基本操作流程

1. **选择源文件夹和目标文件夹**
   - **源文件夹**：点击「选择文件夹」按钮，在弹出的对话框中选择要处理的文件夹
   - **目标文件夹**：
     - 默认情况下，文件将在源文件夹中重命名（勾选"与源文件夹相同"）
     - 要选择不同的目标文件夹，取消勾选"与源文件夹相同"，然后点击「浏览」按钮选择目标文件夹
     - 系统会将文件复制到目标文件夹并应用重命名，**原始文件将保留不变**
     - 系统会在执行操作时自动创建不存在的目标文件夹
   - 系统会自动加载源文件夹中的所有文件

2. **设置文件筛选条件（可选）**
   - **文件类型筛选**：勾选需要处理的文件类型
   - **文件大小筛选**：设置最小和最大文件大小及单位
   - **修改日期筛选**：勾选后设置日期范围

3. **选择重命名模式**
   - 在下拉菜单中选择重命名模式：添加前缀/后缀、替换字符串、正则表达式替换、序号重命名
   - 根据选择的模式设置相应参数

4. **预览修改效果**
   - 点击「预览」按钮
   - 查看原始文件名和新文件名的对比
   - 如果不满意，可以调整参数后重新预览

5. **执行重命名**
   - 确认预览效果后，点击「批量重命名」按钮
   - 系统会显示进度条，并执行重命名操作
   - 完成后会显示操作结果报告

6. **撤销/重做操作**（如果需要）
   - 点击「撤销」按钮可以恢复到之前的文件名
   - 点击「重做」按钮可以重新应用之前的修改

### 重命名模式详解

#### 1. 添加前缀/后缀
- **前缀**：在文件名开头添加的文本
- **后缀**：在文件名扩展名前添加的文本

#### 2. 替换字符串
- **查找内容**：要在文件名中查找的文本
- **替换为**：替换成的新文本
- **区分大小写**：是否区分大小写匹配

#### 3. 正则表达式替换
- **正则表达式**：用于匹配文件名的正则表达式模式
- **替换为**：替换模式，可以使用捕获组（如 `\1`, `\2` 等）

#### 4. 序号重命名
- **前缀文本**：序号前的文本
- **起始序号**：开始计数的数字
- **数字格式**：序号的格式（阿拉伯数字/中文数字/罗马数字）
- **位数**：序号的位数，不足补零
- **后缀文本**：序号后的文本

### 高级技巧

1. **批量修改图片文件名**
   - 选择图片文件夹
   - 筛选 `.jpg`, `.png` 等图片类型
   - 使用序号重命名，设置合适的前缀和起始序号

2. **统一规范文件名格式**
   - 使用正则表达式匹配并标准化日期格式
   - 例如：将 `2023-10-01报告.docx` 改为 `20231001_报告.docx`

3. **批量清理文件名中的特殊字符**
   - 使用替换字符串功能，将特殊字符替换为空或下划线

## 注意事项

1. **备份重要文件**：在处理重要文件前，建议先备份原文件

2. **权限问题**：确保对目标文件夹有读写权限

3. **文件名冲突**：系统会自动处理文件名冲突，但请尽量避免生成相同的新文件名

4. **特殊字符处理**：Windows系统不允许文件名包含以下字符：`"`, `*`, `:`, `<`, `>`, `?`, `|`, `/`, `\`
   程序会自动将这些字符替换为下划线

5. **文件名长度限制**：Windows文件名长度不能超过255个字符，程序会自动截断超长文件名

6. **保留文件名**：避免使用Windows保留文件名（如 CON, PRN, AUX, NUL, COM1-9, LPT1-9 等）

## 常见问题

### Q: 程序无法启动？
A: 请确保已正确安装Python和PyQt5依赖，检查是否有错误提示

### Q: 重命名过程中出现权限错误？
A: 请检查文件是否被其他程序占用，或尝试以管理员身份运行程序

### Q: 正则表达式替换不生效？
A: 请检查正则表达式语法是否正确，确保捕获组格式正确（使用括号）

### Q: 撤销操作失败？
A: 可能是因为文件已被其他程序修改或删除，或权限发生了变化

## 许可证

本项目采用MIT许可证

## 联系我们

如有问题或建议，请通过以下方式联系：
- 邮箱：15629167591@163.com
- GitHub：https://github.com/shrimphope/FileRename
